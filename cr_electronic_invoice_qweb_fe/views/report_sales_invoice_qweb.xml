<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="tax_groups_totals">
            <!--
                Generic template to display a list of tax groups with the related amounts.

                ARGUMENTS:
                - tax_totals: dict in the form generated by account.move's _get_tax_totals.
                - subtotal_to_show: The subtotal we need to render the groups from
            -->
            <t t-foreach="tax_totals['groups_by_subtotal'][subtotal_to_show]" t-as="amount_by_group">
                <t t-set="display_tax_base" t-value="tax_totals['display_tax_base']"/>
                <tr>
                    <t t-if="not display_tax_base">
                        <td style="font-size: 10px; line-height: 10px;"><span class="text-nowrap" t-out="amount_by_group['tax_group_name']">Tax 15%</span></td>
                        <td class="text-end o_price_total" style="font-size: 10px; line-height: 10px;">
                            <span class="text-nowrap" t-out="amount_by_group['formatted_tax_group_amount']">1.05</span>
                        </td>
                    </t>
                    <t t-else="">
                        <td style="font-size: 10px; line-height: 10px;">
                            <span t-out="amount_by_group['tax_group_name']">Tax 15%</span>
                            on 
                            <span class="text-nowrap" t-out="amount_by_group['formatted_tax_group_base_amount']">27.00</span>
                        </td>
                        <td class="text-end o_price_total" style="font-size: 10px; line-height: 10px;">
                            <span class="text-nowrap" t-out="amount_by_group['formatted_tax_group_amount']">4.05</span>
                        </td>
                    </t>
                </tr>
            </t>
        </template>

        <template id="document_tax_totals_template">
            <!--
                Generic template to display tax totals in pdf reports.
                Used by invoices, SO and PO.

                ARGUMENTS:
                - tax_totals: dict in the form generated by account.move's _get_tax_totals.
            -->
            <t t-foreach="tax_totals['subtotals']" t-as="subtotal">
                <tr class="border-black o_subtotal">
                    <td style="font-size: 10px; line-height: 10px;">
                        <!-- <strong t-out="subtotal['name']">Subtotal</strong> -->
                        <strong>Subtotal</strong>
                    </td>

                    <td class="text-end" style="font-size: 10px; line-height: 10px;">
                        <span
                            t-att-class="oe_subtotal_footer_separator"
                            t-out="subtotal['formatted_amount']"
                        >27.00</span>
                    </td>
                </tr>

                <t t-set="subtotal_to_show" t-value="subtotal['name']"/>
                <t t-call="cr_electronic_invoice_qweb_fe.tax_groups_totals"/>
            </t>

            <tr t-if="'formatted_rounding_amount' in tax_totals and tax_totals['rounding_amount'] != 0">
                <td style="font-size: 10px; line-height: 10px;">Rounding</td>
                <td class="text-end" style="font-size: 10px; line-height: 10px;">
                    <span t-out="tax_totals['formatted_rounding_amount']">0</span>
                </td>
            </tr>
            
            <!--Total amount with all taxes-->
            <!-- <tr class="border-black o_total"> -->
            <tr>
                <td style="font-size: 10px; line-height: 10px;"><strong>Total</strong></td>
                <td class="text-end" style="font-size: 10px; line-height: 10px;">
                    <span t-out="tax_totals['formatted_amount_total']">31.05</span>
                </td>
            </tr>
        </template>

        <!-- Allow edits (e.g. studio) without changing the often inherited base template -->
        <template id="document_tax_totals" inherit_id="document_tax_totals_template" primary="True"></template>

        <template id="external_layout_fecr_invoice">
            <t t-if="not o" t-set="o" t-value="doc"/>

            <t t-if="not company">
                <!-- Multicompany -->
                <t t-if="company_id">
                    <t t-set="company" t-value="company_id"/>
                </t>
                <t t-elif="o and 'company_id' in o and o.company_id.sudo()">
                    <t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
                <t t-else="else">
                    <t t-set="company" t-value="res_company"/>
                </t>
            </t>
            <div t-attf-class="header o_company_#{company.id}_layout" t-att-style="report_header_style">
                <div class="row mb8">
                    <div class="col-3">
                        <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo" style="width:100%;max-width:150px;"/>
                    </div>
                    <div class="col-5 text-center mb4" style="color:#144b9d">
                            <h4><strong><t t-esc="o.company_id.commercial_name"/></strong></h4>
                            Teléfono: <t t-esc="o.company_id.phone"/><br/>
                            <t t-if="o.company_id.street" t-esc="o.company_id.street"/>,
                            <t t-if="o.company_id.street2" t-esc="o.company_id.street2"/><br/>
                            <span>
                                Mata Redonda, San José
                                <!--<t t-if="o.company_id.county_id" t-esc="o.company_id.county_id.name"/>,-->
                                <!--<t t-if="o.company_id.district_id" t-esc="o.company_id.district_id.name"/>-->
                                <!--t t-if="o.company_id.country_id" t-esc="o.company_id.country_id.name"/-->
                            </span><br/>
                            Cédula Jurídica No <t t-esc="o.company_id.vat"/><br/>
                            Correo Electrónico:<t t-esc="o.company_id.email"/><br/>
                            <!-- <t t-if="o.company_id.website" t-esc="o.company_id.website"/> -->
                    </div>
                    <div class="col-1"/>
                    <div class="col-3 text-left mb4">
                        <!--div class="text-center"-->
                        <div class="redbold">
                            <h4>
                            <t t-if="o.move_type == 'in_invoice'">
                                <span t-if="not o.number_electronic">FACTURA</span>
                                <span t-if="o.number_electronic and o.tipo_documento=='FE'">FACTURA ELECTRONICA</span>
                                <span t-if="o.number_electronic and o.tipo_documento=='FEC'">FACTURA ELECTRONICA COMPRA</span>
                                <span t-if="o.number_electronic and o.tipo_documento=='TE'">TIQUETE ELECTRONICO</span>
                            </t>
                            <t t-if="o.move_type == 'out_invoice'">
                                <span t-if="o.number_electronic and o.tipo_documento=='FE'">FACTURA ELECTRONICA</span>
                                <span t-if="o.number_electronic and o.tipo_documento=='TE'">TIQUETE ELECTRONICO</span>
                                <span t-if="o.number_electronic and o.tipo_documento=='FEE'">FACTURA ELECTRONICA DE EXPORTACION</span>
                                <span t-if="o.number_electronic and o.tipo_documento=='ND'">NOTA DEBITO ELECTRONICA</span>
                                <span t-if="not o.number_electronic">FACTURA</span>
                            </t>
                            <t t-if="o.move_type == 'out_refund' or o.move_type == 'in_refund'">
                                <span t-if="o.number_electronic">NOTA DE CRÉDITO ELECTRONICA</span>
                                <span t-if="not o.number_electronic">NOTA DE CRÉDITO</span>
                            </t>
                            </h4>
                            Nº
                            <span t-if="o.move_type == 'in_invoice' or o.move_type == 'in_refund'" t-esc="o.ref"/>
                            <span t-if="o.move_type == 'out_invoice' or o.move_type == 'out_refund'" t-esc="o.number_electronic and o.number_electronic[21:41] or o.name"/>
                            <br/>
                        </div>
                        <div>
                            Fecha emisión: <t t-esc="o.date_issuance or o.invoice_date or ''"/><br/>
                            Fecha vence:<span t-field="o.invoice_date_due"/>
                            Tipo pago: <t t-esc="o.invoice_payment_term_id and o.invoice_payment_term_id.name or 'CONTADO'"/><br/>
                            Medio pago: <t t-esc="o.payment_methods_id and o.payment_methods_id.name or 'Efectivo'"/>
                        </div>
                        <div t-if="report_type == 'pdf'" class="text-muted">
                            Página: <span class="page"/> / <span class="topage"/>
                        </div>
                    </div>
                </div>
                <div class="row mb8">
                    <div class="col-1">
                        <span t-if="o.move_type == 'in_invoice' or o.move_type == 'in_refund'">
                            <strong>Proveedor:</strong>
                        </span>
                        <span t-if="o.move_type == 'out_invoice' or o.move_type == 'out_refund'">
                            <strong>Cliente:</strong>
                            </span>
                    </div>
                    <div class="col-8">
                        <t t-if="o.partner_id.parent_id">
                            <span t-field="o.partner_id.parent_id.name"/><br/>
                        </t>
                        <span t-field="o.partner_id.name"/>
                    </div>
                    <div class="col-2">
                        <strong>Identificación:</strong>
                    </div>
                    <div class="col-1">
                        <span t-field="o.partner_id.vat"/>
                    </div>
                </div>
                <div t-if="o.move_type == 'out_invoice' or o.move_type == 'out_refund'" class="row mb8">
                    <div class="col-1">
                        <span>
                            <strong>Agencia:</strong>
                        </span>
                    </div>
                    <div class="col-8">
                        <span t-field="o.partner_shipping_id.name"/>
                    </div>
                    <div class="col-1">
                    </div>
                    <div class="col-2">
                    </div>
                </div>
                <t t-if="company.watermark">
                    <!--div class="row"
                        style="height:1000px; width:1500px;margin-left:10%;margin-top:30%;"-->
                    <div class="row" style="margin-left:0%;margin-top:20%;">
                        <div class="col-6" name="watermark">
                            <span t-attf-style="-webkit-transform:rotate(-{{company.rotating_angle}}deg);font-size:{{company.font_size}}px;text-align:center;position:absolute;text-align:center;opacity:1;">
                                <t t-if="company.watermark_type == 'text'">
                                    <t t-esc="company.content_text"/>
                                </t>
                                <t t-if="company.watermark_type == 'image'">
                                    <img t-if="company.background_image" t-att-src="image_data_uri(company.background_image)"/>
                                </t>
                                <t t-if="company.watermark_type == 'logo'">
                                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="position:absolute;height:200px; width:300px; opacity: 1;"/>
                                </t>
                            </span>
                        </div>
                    </div>
                </t>

                <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css"/>
                <style type="text/css">
                    body {
                        font-family: 'Droid Sans', Arial, sans-serif;
                        font-size:12px;

                    }
                    .redbold{
                        color:#ec2028;
                        font-weight:bolder;
                        font-size:13px;
                        border:none;
                        padding:5px 5px;
                    }
                </style>
            </div>

            <div t-attf-class="article o_report_layout_standard o_company_#{company.id}_layout {{  'o_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  '' }}" t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                <div class="pt-5">
                    <!-- This div ensures that the address is not cropped by the header. -->
                    <t t-call="web.address_layout"/>
                </div>
                <t t-out="0"/>
            </div>

            <div t-attf-class="footer o_standard_footer o_company_#{company.id}_layout">
                <!--div t-if="company.report_footer" class="text-center" style="border-top: 1px solid black;">
                    <ul class="list-inline mb4">
                        <div t-field="company.report_footer"/>
                    </ul>
                </div-->

                <t t-if="o.move_type in ('out_invoice', 'out_refund')">
                    <div class="cuadro-bancos">
                        <div class="encabezado-bancos">CUALQUIER RECLAMO REFERENTE A ESTA 
                        <t t-if="o.move_type == 'out_invoice'">FACTURA</t>
                        <t t-if="o.move_type == 'out_refund'">NOTA DE CRÉDITO</t>
                        DEBE HACERSE EN LOS SIGUIENTES 5 DIAS HABILES DE LA FECHA DE RECIBIDA.</div>
                        <!--p style="font-size:14px;padding:2px;text-align:justify;">
                            Este documento constituye factura comercial con titulo ejecutivo de acuerdo al art. 460 del Código de Comercio
                            que podrá hacerse efectivo el día de su vencimiento y en caso de ejecución, renuncio a mi domicilio y los
                            trámites de juicio ejecutivo. Esta factura devengará 3% mensual después de su vencimiento.
                        </p-->
                        <t t-if="o.move_type =='out_invoice' and (o.company_id.html_bank_account1 or o.company_id.html_bank_account2)">
                            <strong>Cuentas bancarias para transferencias o depósitos:</strong>
                            <table width="100%;" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td width="50%"> <t t-raw="o.company_id.html_bank_account1"/>
                                        <!--p style="font-size:16px;">
                                            <strong>XXXXXX</strong><br/>
                                            Cuenta: XXXXX<br/>
                                            CC: XXXXXX<br/>
                                            IBAN: XXXXX
                                        </p-->
                                    </td>
                                    <td> <t t-raw="o.company_id.html_bank_account2"/>
                                        <!--p style="font-size:16px;">
                                            <strong>XXXXX</strong><br/>
                                            Cuenta: XXXXX<br/>
                                            CC: XXXXX<br/>
                                            IBAN: XXXXX
                                        </p-->
                                    </td>
                                </tr>
                            </table>
                            <strong>CONFIRMACIONES:</strong> Para enviar confirmaciones de depósito    Correo:   <span t-field="o.company_id.email"/>
                        </t>
                        <t t-if="o.move_type != 'out_invoice'">
                            <div class="rounded2">
                                <table width="100%;" cellpadding="0" cellspacing="0">
                                    <tr class="text-center">
                                        <td width="34%"><br/><br/><br/>__________________________</td>
                                        <td width="33%"><br/><br/><br/>__________________________</td>
                                        <td width="33%"><br/><br/><br/>__________________________</td>
                                    </tr>
                                    <tr class="text-center">
                                        <td>Registrado por</td>
                                        <td>Fecha</td>
                                        <td>Revisado por</td>
                                    </tr>
                                </table>
                            </div>
                            <br/>
                        </t>
                            Certificado de dispensa del uso del timbre Ley No. 5527 autorizado por el Colegio de Periodistas de Costa Rica No. CDCE07-005-03<br/>
    AUTORIZADO MEDIANTE OFICIO No DGTR-033-2019 DEL 20/06/2019<br/>
    CN: <span t-field="o.number_electronic"/>
                        <div class="pie-bancos">
                            <t t-if="o.move_type == 'out_invoice'">Esta factura posterior a su fecha de vencimiento devengara un 2% mensual de interés moratorio.</t>
                        </div>
                    </div>
                </t>
                <style type="text/css">
                    .cuadro-bancos {
                    border: 1px solid #3e783f;
                    border-radius: 10px 10px 10px 10px; /* Bordes redondeados */
                    width:100%;
                    font-family: sans-serif;
                    }
                    
                    .encabezado-bancos {
                    background-color: #dff0d8;
                    color: #3e783f;
                    padding: 10px;
                    /*font-weight: bold;*/
                    border-radius: 10px 10px 0 0;
                    }
                    .pie-bancos {
                    background-color: #dff0d8;
                    color: #3e783f;
                    padding: 10px;
                    /*font-weight: bold;*/
                    border-radius: 0 0 10px 10px;
                    }

                </style>
            </div>
        </template>

        <template id="report_invoice_document_fecr">
            <t t-call="cr_electronic_invoice_qweb_fe.external_layout_fecr_invoice">
                <div class="page" style="height:160mm;width:100%">
                    <t t-set="lines" t-value="o.invoice_line_ids"/>
                    <t t-set="lines_count" t-value="len(lines)"/>
                    <t t-set="page_height" t-value="160"/> <!-- Altura máxima en mm para el contenido -->
                    <t t-set="line_height" t-value="11"/>  <!-- Altura estimada de cada línea en mm -->
                    <!--t t-set="lines_per_page" t-value="int(page_height / line_height)"/-->
                    <t t-set="lines_per_page" t-value="15"/>

                    <div class="content">
                        <t t-foreach="range(0, lines_count, lines_per_page)" t-as="page_index">
                            <t t-if="page_index > 0"><br/></t>
                            <div class="cuadro-detalle" style="height:160mm;">
                                <div class="encabezado">Detalle</div>
                                <div class="contenido">
                                    <table class="ttable">
                                        <thead>
                                            <tr>
                                                <th class="tthl">Descripción</th>
                                                <th width="15%" class="tth">Monto Bruto</th>
                                                <th width="15%" class="tth">Descuento</th>
                                                <th width="10%" class="tth">Impuestos</th>
                                                <th width="15%" class="tth">Monto Neto</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="lines[page_index:page_index + lines_per_page]" t-as="l">
                                                <tr class="ttd">
                                                    <td class="ttdl">
                                                        <span t-field="l.name"/>
                                                    </td>
                                                    <td class="ttd">
                                                        <span t-field="l.price_unit" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                                                    </td>
                                                    <td class="ttd" groups="product.group_discount_per_so_line">
                                                        <span t-esc="l.price_unit * l.discount / 100" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                                                    </td>
                                                    <td class="ttd">
                                                        <span t-if="l.tax_ids" t-esc="', '.join(map(lambda x: (x.description or x.name), l.tax_ids))"/>
                                                        <span t-if="not l.tax_ids">EXE</span>
                                                    </td>
                                                    <td class="ttd">
                                                        <span t-field="l.price_subtotal" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </tbody>
                                        <tfoot class="ttfoot">
                                            <tr>
                                                <td colspan="5"></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                            <t t-if="page_index + lines_per_page >= lines_count">
                                <table class="totals" style="width:100%">
                                    <tr>
                                        <td width="60%">
                                            <t t-if="o.narration" class="text-center" style="height:25px;">
                                                <strong>Observaciones:</strong><br/>
                                                <span class="text-center">
                                                    <br/><span t-field="o.narration"/>
                                                </span>
                                            </t>
                                        </td>
                                        <td class="text-right">
                                            <table class="table" style="page-break-inside: avoid;">
                                                <!--Tax totals-->
                                                <t t-set="tax_totals" t-value="o.tax_totals"/>
                                                <t t-call="cr_electronic_invoice_qweb_fe.document_tax_totals"/>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                                <strong>TOTAL EN LETRAS:</strong><span t-field="o.invoice_amount_text" />
                            </t>
                                </div>
                            </div>
                            <!-- Salto de página después de cada tabla, excepto la última -->
                            <t t-if="page_index + lines_per_page &lt; lines_count">
                                <p style="page-break-before:always;"> </p>
                            </t>
                            <!--div t-if="page_index + lines_per_page &lt; lines_count" class="page-break"/-->
                        </t>
                    </div>


                    <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css"/>
                    <style type="text/css">

                        body {
                            font-family: 'Droid Sans', Arial, sans-serif;
                            font-size:12px;
                        }

                        .cuadro-detalle {
                        border: 1px solid #3c7896;
                        border-radius: 10px 10px 0 0; /* Bordes redondeados solo arriba */
                        height:160mm;
                        width:100%;
                        font-family: sans-serif;
                        /*overflow: hidden; / * Importante para evitar que el contenido se desborde */
                        }

                        .contenido {
                        page-break-inside: avoid; /* Evita saltos de página dentro del div.contenido */
                        }

                        .totals {
                        page-break-inside: avoid; /* Evita saltos de página dentro del div.contenido */
                        }

                        .ttable {
                        width: 100%;
                        border-collapse: collapse;
                        }

                        .tth {
                        padding: 8px;
                        text-align:right;
                        }

                        .tthl {
                        padding: 8px;
                        text-align:left;
                        }

                        .ttd, .ttdl {
                        padding: 8px;
                        height: auto;  /* Permitir que las filas se ajusten al contenido */
                        text-align: right;
                        border-top: 1px solid lightgray; /* Línea horizontal entre filas */
                        page-break-inside: avoid; /* Evita saltos de página dentro de una fila */
                        }

                        .ttdl {
                        text-align: left;
                        }

                        .ttfoot {
                        border-top: 2px solid #144b9d; /* Línea azul en el pie de tabla */
                        border-bottom: none;
                        }

                        /* Estilos para controlar los saltos de página */
                        .ttable tbody tr {
                            page-break-inside: avoid;
                        }

                        @media print {
                            .page-break {
                                display: block;
                                page-break-before: always;
                            }
                        }

                        .encabezado {
                        background-color: #d9edf8;
                        color: #3c7896;
                        padding: 10px;
                        font-weight: bold;
                        border-radius: 10px 10px 0 0;
                        }
                    </style>
                </div>
            </t>
        </template>

        <template id="account.report_invoice">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-set="lang" t-value="o.partner_id.lang"/>
                    <t t-if="o._get_name_invoice_report() == 'account.report_invoice_document'" t-call="account.report_invoice_document" t-lang="lang"/>
                    <t t-if="o._get_name_invoice_report() == 'cr_electronic_invoice_qweb_fe.report_invoice_document_fecr'" t-call="cr_electronic_invoice_qweb_fe.report_invoice_document_fecr" t-lang="lang"/>
                </t>
            </t>
        </template>

        <template id="account.report_invoice_with_payments">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-set="lang" t-value="o.partner_id.lang"/>
                    <t t-set="print_with_payments" t-value="True"/>
                    <t t-if="o._get_name_invoice_report() == 'account.report_invoice_document'" t-call="account.report_invoice_document" t-lang="lang"/>
                    <t t-if="o._get_name_invoice_report() == 'cr_electronic_invoice_qweb_fe.report_invoice_document_fecr'" t-call="cr_electronic_invoice_qweb_fe.report_invoice_document_fecr" t-lang="lang"/>
                </t>
            </t>
        </template>

        <template id="external_layout_purchase_tvcr">
            <t t-if="not o" t-set="o" t-value="doc"/>

            <t t-if="not company">
                <!-- Multicompany -->
                <t t-if="company_id">
                    <t t-set="company" t-value="company_id"/>
                </t>
                <t t-elif="o and 'company_id' in o and o.company_id.sudo()">
                    <t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
                <t t-else="else">
                    <t t-set="company" t-value="res_company"/>
                </t>
            </t>
            <div t-attf-class="header o_company_#{company.id}_layout" t-att-style="report_header_style">
                <div class="row mb8">
                    <div class="col-3">
                        <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo" style="width:100%;max-width:150px;"/>
                    </div>
                    <div class="col-5 text-center mb4" style="color:#144b9d">
                        <h4><strong><t t-esc="o.company_id.commercial_name"/></strong></h4>
                        Mata Redonda, San José
                        <!--<t t-if="o.company_id.street" t-esc="o.company_id.street"/>,-->
                        <!--<t t-if="o.company_id.street2" t-esc="o.company_id.street2"/><br/>-->
                        Apdo. 3876-1000 San José<br/>
                        <span>Teléfono:</span> <t t-esc="o.company_id.phone"/><br/>
                        Cédula Jurídica No <t t-esc="o.company_id.vat"/><br/>
                    </div>
                    <div class="col-1"/>
                    <div class="col-3 text-left mb4">
                        <!--div class="text-center"-->
                        <div class="redbold">
                            <h5 t-if="o.state in ['draft', 'sent', 'to approve']"><strong>SOLICITUD DE COTIZACIÓN</strong></h5>
                            <h5 t-if="o.state in ['purchase', 'done']"><strong>ORDEN DE COMPRA</strong></h5>
                            <h5 t-if="o.state == 'cancel'"><strong>ORDEN DE COMPRA ANULADA</strong></h5>
                            No.<span t-esc="o.name"/>
                            <br/>
                        </div>
                        <div>
                            Fecha emisión: <t t-esc="o.date_approve"/><br/>
                            Condición de Pago: <t t-esc="o.payment_term_id and o.payment_term_id.name or 'CONTADO'"/><br/>
                            Moneda: <span t-esc="o.currency_id.name=='CRC' and 'Colones' or 'Dólares'"/>
                            <div t-if="report_type == 'pdf'" class="text-muted">
                                Página: <span class="page"/> / <span class="topage"/>
                            </div>
                        </div>
                    </div>
                </div>
                <!--<div class="encabezado-proveedor">-->
                    <div class="row mb8">
                        <div class="col-2">
                                <strong>Suplidor:</strong>
                        </div>
                        <div class="col-7">
                            <t t-if="o.partner_id.parent_id">
                                <span t-field="o.partner_id.parent_id.name"/>-<span t-field="o.partner_id.parent_id.ref"/><br/>
                            </t>
                            <t t-else="">
                                <span t-field="o.partner_id.name"/>-<span t-field="o.partner_id.ref"/>
                            </t>
                        </div>
                        <div class="col-1">
                            <strong>Contacto:</strong>
                        </div>
                        <div class="col-2">
                            <span t-field="o.user_id.name"/>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-2">
                            <span>
                                <strong>Fecha de Entrega:</strong>
                            </span>
                        </div>
                        <div class="col-7">
                            <span t-field="o.date_order"/> <!--date_planned-->
                        </div>
                        <div class="col-1">
                            <strong>Teléfono:</strong>
                        </div>
                        <div class="col-2">
                            <span t-field="o.user_id.phone"/>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-2">
                            <span>
                                <strong>Lugar de Entrega:</strong>
                            </span>
                        </div>
                        <div class="col-7">
                            <span t-field="o.picking_type_id.warehouse_id.partner_id.street"/>
                            <span t-field="o.picking_type_id.warehouse_id.partner_id.street2"/>
                        </div>
                        <div class="col-1">
                            <strong>Correo:</strong>
                        </div>
                        <div class="col-2">
                            <span t-field="o.user_id.email"/>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-2">
                            <span>
                                <div t-if="o.partner_ref" class="col-3 bm-2">
                                    <strong>Su Referencia:</strong>
                                    <p t-field="o.partner_ref" class="m-0"/>
                                </div>
                                <!--<strong>Observaciones:</strong>-->
                            </span>
                        </div>
                        <div class="col-10">
                            <!--<span t-field="o.notes"/>-->
                        </div>
                    </div>
                <!--</div>-->
                <t t-if="company.watermark">
                    <!--div class="row"
                            style="height:1000px; width:1500px;margin-left:10%;margin-top:30%;"-->
                    <!--<div class="row" style="margin-left:0%;margin-top:20%;">-->
                    <div class="row">
                        <div class="col-6" name="watermark">
                            <span t-attf-style="-webkit-transform:rotate(-{{company.rotating_angle}}deg);font-size:{{company.font_size}}px;text-align:center;position:absolute;text-align:center;opacity:1;">
                                <t t-if="company.watermark_type == 'text'">
                                    <t t-esc="company.content_text"/>
                                </t>
                                <t t-if="company.watermark_type == 'image'">
                                    <img t-if="company.background_image" t-att-src="image_data_uri(company.background_image)"/>
                                </t>
                                <t t-if="company.watermark_type == 'logo'">
                                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="position:absolute;height:200px; width:300px; opacity: 1;"/>
                                </t>
                            </span>
                        </div>
                    </div>
                </t>

                <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css"/>
                <style type="text/css">
                    body {
                        font-family: 'Droid Sans', Arial, sans-serif;
                        font-size:12px;

                    }
                    .redbold{
                        color:#ec2028;
                        font-weight:bolder;
                        font-size:13px;
                        border:none;
                        padding:5px 5px;
                    }
                    .encabezado-proveedor {
                        background-color: #f6deb3;
                        border: 1px solid; /*#3e783f;*/
                        /*border-radius: 10px 10px 10px 10px; / * Bordes redondeados */
                        padding: 10px;
                        /*font-weight: bold;*/
                    }
                </style>
            </div>

            <div t-attf-class="article o_report_layout_standard o_company_#{company.id}_layout {{  'o_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  '' }}" t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                <div class="pt-5">
                    <t t-call="web.address_layout"/>
                </div>
                <t t-out="0"/>
            </div>

            <div t-attf-class="footer o_standard_footer o_company_#{company.id}_layout">
                <!--div t-if="company.report_footer" class="text-center" style="border-top: 1px solid black;">
                    <ul class="list-inline mb4">
                        <div t-field="company.report_footer"/>
                    </ul>
                </div-->

                <div class="cuadro-pie">
                    <div class="row mb8">
                        <div class="invoice-cell col-9">
                            <p class="text-center"><strong>Esta orden es NULA sin la firma de la persona autorizada por TVCR</strong></p>
                            <strong>SEÑOR SUPLIDOR:</strong>
                            <li>La validez del presente documento está condicionada a su confirmación de recibido directamente al correo compras@teletica.com</li>
                            <li>Sírvase presentar esa orden de compra con el original de la factura para trámite de entrega o pago.</li>
                            <li>Si después de un plazo máximo de 30 días de emitida la factura no ha sido puesta al cobro, no se le dará trámite de pago.</li>
                        </div>
                        <div class="invoice-cell col-3">
                            <p class="text-center"><strong>Firma:</strong></p>
                        </div>
                    </div>
                </div>
                <p>Estimado Proveedor, es importante que el monto del Impuesto sobre las Ventas se muestre en su factura por separado cuando se trate de ítems o servicios gravados
        en cumplimiento a la Ley General sobe el Impuesto de Ventas y su Reglamento en el artículo 18, incisos 16, 17 y, 18. Cualquier documento que no cumpla con lo
        establecido no podrá ser tramitado.</p>
                <style type="text/css">
                    body {
                        font-family: 'Droid Sans', Arial, sans-serif;
                        font-size:12px;

                    }
                    .invoice-cell {
                    border: 1px solid black;
                    padding: 8px;
                    text-align: left;
                    }
                </style>
            </div>
       </template>

        <template id="report_purchaseorder_document_tvcr">
            <t t-call="cr_electronic_invoice_qweb_fe.external_layout_purchase_tvcr">
            <!--t t-call="web.external_layout"-->
                <!--t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/-->
                <div class="page" style="height:140mm;width:100%">
                    <!--div class="oe_structure"/-->
                    <div class="cuadro-detalle" style="height:140mm;">
                        <table class="table table-sm o_main_table mt-4 invoice-table">
                            <thead class="invoice-header" style="display: table-row-group">
                                <tr>
                                    <th name="th_quantity" class="invoice-header-cell text-end"><strong>Cant</strong></th>
                                    <th name="th_description" class="invoice-header-cell"><strong>Descripción</strong></th>
                                    <!--<th name="th_date_req" class="text-center"><strong>Fecha Req.</strong></th>-->
                                    <th name="th_price_unit" class="invoice-header-cell text-end"><strong>Precio Unitario</strong></th>
                                    <th name="th_taxes" class="invoice-header-cell text-end"><strong>Impuestos</strong></th>
                                    <th name="th_subtotal" class="invoice-header-cell text-end"><strong>Total</strong></th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="current_subtotal" t-value="0"/>
                                <t t-foreach="o.order_line" t-as="line">
                                    <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"/>
    
                                    <tr t-att-class="'bg-200 fw-bold o_line_section' if line.display_type == 'line_section' else 'fst-italic o_line_note' if line.display_type == 'line_note' else ''">
                                        <t t-if="not line.display_type">
                                            <td class="invoice-cell text-end">
                                                <span t-field="line.product_qty"/>
                                            </td>
                                            <td id="product" class="invoice-cell">
                                                <span t-field="line.name"/>
                                            </td>
                                            <!--<td class="text-center">-->
                                            <!--    <span t-field="line.date_planned"/>-->
                                            <!--</td>-->
                                            <td class="invoice-cell text-end">
                                                <span t-field="line.price_unit"/>
                                            </td>
                                            <t t-set="taxes" t-value="', '.join([(tax.invoice_label or tax.name) for tax in line.taxes_id])"/>
                                            <td name="td_taxes" t-attf-class="invoice-cell text-end {{ 'text-nowrap' if len(taxes) &lt; 10 else '' }}">
                                                <span t-out="taxes">Tax 15%</span>
                                            </td>
                                            <td class="invoice-cell text-end">
                                                <span t-field="line.price_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                            </td>
                                        </t>
                                        <t t-if="line.display_type == 'line_section'">
                                            <td colspan="99" id="section">
                                                <span t-field="line.name"/>
                                            </td>
                                            <t t-set="current_section" t-value="line"/>
                                            <t t-set="current_subtotal" t-value="0"/>
                                        </t>
                                        <t t-if="line.display_type == 'line_note'">
                                            <td colspan="99" id="note">
                                                <span t-field="line.name"/>
                                            </td>
                                        </t>
                                    </tr>
                                    <t t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
                                        <tr class="is-subtotal text-end">
                                            <td colspan="99" id="subtotal">
                                                <strong class="mr16">Subtotal</strong>
                                                <span t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                        <div id="total" class="row justify-content-end">
                            <div class="col-4">
                                <table class="table table-sm table-borderless">
                                    <t t-set="tax_totals" t-value="o.tax_totals"/>
                                    <t t-call="cr_electronic_invoice_qweb_fe.document_tax_totals"/>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!--div class="oe_structure"/-->
                    <style type="text/css">
                        body {
                            font-family: 'Droid Sans', Arial, sans-serif;
                            font-size:12px;
            
                        }
                        .cuadro-detalle {
                            border: 1px solid #3c7896;
                            border-radius: 10px 10px 0 0; /* Bordes redondeados solo arriba */
                            height:140mm;
                            width:100%;
                            font-family: sans-serif;
                            /*overflow: hidden; / * Importante para evitar que el contenido se desborde */
                        }

                        .encabezado {
                            background-color: #d9edf8;
                            color: #3c7896;
                            padding: 10px;
                            font-weight: bold;
                            border-radius: 10px 10px 0 0;
                        }
                        .invoice-table {
                        border-collapse: collapse;
                        width: 100%; /* Opcional: Ancho de la tabla */
                        }
                        
                        .invoice-cell, .invoice-header-cell {
                            border: 1px solid #3c7896;
                        padding: 8px;
                        text-align: left;
                        }
                        
                        .invoice-header {
                            background-color: #d9edf8;
                            color: #3c7896;
                        }
                    </style>
                </div>
            </t>
        </template>

        <template id="purchase.report_purchaseorder">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-set="lang" t-value="o.partner_id.lang"/>
                    <t t-call="cr_electronic_invoice_qweb_fe.report_purchaseorder_document_tvcr" t-lang="lang"/>
                </t>
            </t>
        </template>

        <template id="external_layout_request_tvcr">
            <t t-if="not o" t-set="o" t-value="doc"/>

            <t t-if="not company">
                <!-- Multicompany -->
                <t t-if="company_id">
                    <t t-set="company" t-value="company_id"/>
                </t>
                <t t-elif="o and 'company_id' in o and o.company_id.sudo()">
                    <t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
                <t t-else="else">
                    <t t-set="company" t-value="res_company"/>
                </t>
            </t>
            <div t-attf-class="header o_company_#{company.id}_layout" t-att-style="report_header_style">
                <div class="row mb8">
                    <div class="col-3">
                        <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo" style="width:100%;max-width:150px;"/>
                    </div>
                    <div class="col-5 text-center mb4" style="color:#144b9d">
                        <h4><strong><t t-esc="o.company_id.commercial_name"/></strong></h4>
                        Mata Redonda, San José
                        <!--<t t-if="o.company_id.street" t-esc="o.company_id.street"/>,-->
                        <!--<t t-if="o.company_id.street2" t-esc="o.company_id.street2"/><br/>-->
                        Apdo. 3876-1000 San José<br/>
                        <span>Teléfono:</span> <t t-esc="o.company_id.phone"/><br/>
                        Cédula Jurídica No <t t-esc="o.company_id.vat"/><br/>
                    </div>
                    <div class="col-1"/>
                    <div class="col-3 text-left mb4">
                        <!--div class="text-center"-->
                        <div class="redbold">
                            <h5 t-if="o.state in ['draft', 'sent', 'to approve']"><strong>SOLICITUD DE COTIZACIÓN</strong></h5>
                            <h5 t-if="o.state in ['purchase', 'done']"><strong>SOLICITUD DE COTIZACIÓN</strong></h5>
                            <h5 t-if="o.state == 'cancel'"><strong>SOLICITUD DE COTIZACIÓN ANULADA</strong></h5>
                            No.<span t-esc="o.name"/>
                            <br/>
                        </div>
                        <div>
                            Fecha emisión: <t t-esc="o.date_approve"/><br/>
                            <!-- Condición de Pago: <t t-esc="o.payment_term_id and o.payment_term_id.name or 'CONTADO'"/><br/>
                            Moneda: <span t-esc="o.currency_id.name=='CRC' and 'Colones' or 'Dólares'"/> -->
                            <div t-if="report_type == 'pdf'" class="text-muted">
                                Página: <span class="page"/> / <span class="topage"/>
                            </div>
                        </div>
                    </div>
                </div>
                <!--<div class="encabezado-proveedor">-->
                    <div class="row mb8">
                        <div class="col-2">
                                <strong>Suplidor:</strong>
                        </div>
                        <div class="col-7">
                            <t t-if="o.partner_id.parent_id">
                                <span t-field="o.partner_id.parent_id.name"/>-<span t-field="o.partner_id.parent_id.ref"/><br/>
                            </t>
                            <t t-else="">
                                <span t-field="o.partner_id.name"/>-<span t-field="o.partner_id.ref"/>
                            </t>
                        </div>
                        <div class="col-1">
                            <strong>Contacto:</strong>
                        </div>
                        <div class="col-2">
                            <span t-field="o.user_id.name"/>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-2">
                            <span>
                                <strong>Fecha de Entrega:</strong>
                            </span>
                        </div>
                        <div class="col-7">
                            <span t-field="o.date_order"/> <!--date_planned-->
                        </div>
                        <div class="col-1">
                            <strong>Teléfono:</strong>
                        </div>
                        <div class="col-2">
                            <span t-field="o.user_id.phone"/>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-2">
                            <span>
                                <strong>Lugar de Entrega:</strong>
                            </span>
                        </div>
                        <div class="col-7">
                            <span t-field="o.picking_type_id.warehouse_id.partner_id.street"/>
                            <span t-field="o.picking_type_id.warehouse_id.partner_id.street2"/>
                        </div>
                        <div class="col-1">
                            <strong>Correo:</strong>
                        </div>
                        <div class="col-2">
                            <span t-field="o.user_id.email"/>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-2">
                            <span>
                                <div t-if="o.partner_ref" class="col-3 bm-2">
                                    <strong>Su Referencia:</strong>
                                    <p t-field="o.partner_ref" class="m-0"/>
                                </div>
                                <!--<strong>Observaciones:</strong>-->
                            </span>
                        </div>
                        <div class="col-10">
                            <!--<span t-field="o.notes"/>-->
                        </div>
                    </div>
                <!--</div>-->
                <t t-if="company.watermark">
                    <!--div class="row"
                            style="height:1000px; width:1500px;margin-left:10%;margin-top:30%;"-->
                    <!--<div class="row" style="margin-left:0%;margin-top:20%;">-->
                    <div class="row">
                        <div class="col-6" name="watermark">
                            <span t-attf-style="-webkit-transform:rotate(-{{company.rotating_angle}}deg);font-size:{{company.font_size}}px;text-align:center;position:absolute;text-align:center;opacity:1;">
                                <t t-if="company.watermark_type == 'text'">
                                    <t t-esc="company.content_text"/>
                                </t>
                                <t t-if="company.watermark_type == 'image'">
                                    <img t-if="company.background_image" t-att-src="image_data_uri(company.background_image)"/>
                                </t>
                                <t t-if="company.watermark_type == 'logo'">
                                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="position:absolute;height:200px; width:300px; opacity: 1;"/>
                                </t>
                            </span>
                        </div>
                    </div>
                </t>

                <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css"/>
                <style type="text/css">
                    body {
                        font-family: 'Droid Sans', Arial, sans-serif;
                        font-size:12px;

                    }
                    .redbold{
                        color:#ec2028;
                        font-weight:bolder;
                        font-size:13px;
                        border:none;
                        padding:5px 5px;
                    }
                    .encabezado-proveedor {
                        background-color: #f6deb3;
                        border: 1px solid; /*#3e783f;*/
                        /*border-radius: 10px 10px 10px 10px; / * Bordes redondeados */
                        padding: 10px;
                        /*font-weight: bold;*/
                    }
                </style>
            </div>

            <div t-attf-class="article o_report_layout_standard o_company_#{company.id}_layout {{  'o_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  '' }}" t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                <div class="pt-5">
                    <t t-call="web.address_layout"/>
                </div>
                <t t-out="0"/>
            </div>

            <div t-attf-class="footer o_standard_footer o_company_#{company.id}_layout">
                <!--div t-if="company.report_footer" class="text-center" style="border-top: 1px solid black;">
                    <ul class="list-inline mb4">
                        <div t-field="company.report_footer"/>
                    </ul>
                </div-->

                <div class="cuadro-pie">
                    <div class="row mb8">
                        <div class="invoice-cell col-9">
                            <p class="text-center"><strong>Esta orden es NULA sin la firma de la persona autorizada por TVCR</strong></p>
                            <strong>SEÑOR SUPLIDOR:</strong>
                            <li>La validez del presente documento está condicionada a su confirmación de recibido directamente al correo compras@teletica.com</li>
                            <li>Sírvase presentar esa orden de compra con el original de la factura para trámite de entrega o pago.</li>
                            <li>Si después de un plazo máximo de 30 días de emitida la factura no ha sido puesta al cobro, no se le dará trámite de pago.</li>
                        </div>
                        <div class="invoice-cell col-3">
                            <p class="text-center"><strong>Firma:</strong></p>
                        </div>
                    </div>
                </div>
                <p>Estimado Proveedor, es importante que el monto del Impuesto sobre las Ventas se muestre en su factura por separado cuando se trate de ítems o servicios gravados
        en cumplimiento a la Ley General sobe el Impuesto de Ventas y su Reglamento en el artículo 18, incisos 16, 17 y, 18. Cualquier documento que no cumpla con lo
        establecido no podrá ser tramitado.</p>
                <style type="text/css">
                    body {
                        font-family: 'Droid Sans', Arial, sans-serif;
                        font-size:12px;

                    }
                    .invoice-cell {
                    border: 1px solid black;
                    padding: 8px;
                    text-align: left;
                    }
                </style>
            </div>
       </template>

        <template id="report_purchasequotation_document_tvcr">
            <t t-call="cr_electronic_invoice_qweb_fe.external_layout_request_tvcr">
            <!--t t-call="web.external_layout"-->
                <!--t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/-->
                <div class="page" style="height:140mm;width:100%">
                    <!--div class="oe_structure"/-->
                    <div class="cuadro-detalle" style="height:140mm;">
                        <table class="table table-sm o_main_table mt-4 invoice-table">
                            <thead class="invoice-header" style="display: table-row-group">
                                <tr>
                                    <th name="th_quantity" class="invoice-header-cell text-end"><strong>Cant</strong></th>
                                    <th name="th_description" class="invoice-header-cell"><strong>Descripción</strong></th>
                                    <th name="th_date_req" class="text-center"><strong>Fecha Req.</strong></th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="current_subtotal" t-value="0"/>
                                <t t-foreach="o.order_line" t-as="line">
                                    <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"/>
    
                                    <tr t-att-class="'bg-200 fw-bold o_line_section' if line.display_type == 'line_section' else 'fst-italic o_line_note' if line.display_type == 'line_note' else ''">
                                        <t t-if="not line.display_type">
                                            <td class="invoice-cell text-end">
                                                <span t-field="line.product_qty"/>
                                            </td>
                                            <td id="product" class="invoice-cell">
                                                <span t-field="line.name"/>
                                            </td>
                                            <td class="text-center">
                                                <span t-field="line.date_planned"/>
                                            </td>
                                        </t>
                                        <t t-if="line.display_type == 'line_section'">
                                            <td colspan="99" id="section">
                                                <span t-field="line.name"/>
                                            </td>
                                            <t t-set="current_section" t-value="line"/>
                                            <t t-set="current_subtotal" t-value="0"/>
                                        </t>
                                        <t t-if="line.display_type == 'line_note'">
                                            <td colspan="99" id="note">
                                                <span t-field="line.name"/>
                                            </td>
                                        </t>
                                    </tr>
                                    <t t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
                                        <tr class="is-subtotal text-end">
                                            <td colspan="99" id="subtotal">
                                                <strong class="mr16">Subtotal</strong>
                                                <span t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                    </div>
                    <!--div class="oe_structure"/-->
                    <style type="text/css">
                        body {
                            font-family: 'Droid Sans', Arial, sans-serif;
                            font-size:12px;
            
                        }
                        .cuadro-detalle {
                            border: 1px solid #3c7896;
                            border-radius: 10px 10px 0 0; /* Bordes redondeados solo arriba */
                            height:140mm;
                            width:100%;
                            font-family: sans-serif;
                            /*overflow: hidden; / * Importante para evitar que el contenido se desborde */
                        }

                        .encabezado {
                            background-color: #d9edf8;
                            color: #3c7896;
                            padding: 10px;
                            font-weight: bold;
                            border-radius: 10px 10px 0 0;
                        }
                        .invoice-table {
                        border-collapse: collapse;
                        width: 100%; /* Opcional: Ancho de la tabla */
                        }
                        
                        .invoice-cell, .invoice-header-cell {
                            border: 1px solid #3c7896;
                        padding: 8px;
                        text-align: left;
                        }
                        
                        .invoice-header {
                            background-color: #d9edf8;
                            color: #3c7896;
                        }
                    </style>
                </div>
            </t>
        </template>


        <template id="purchase.report_purchasequotation">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="o">
                    <t t-call="cr_electronic_invoice_qweb_fe.report_purchasequotation_document_tvcr" t-lang="o.partner_id.lang"/>
                </t>
            </t>
        </template>


        <template id="external_layout_payment_receipt_tvcr">
            <t t-if="not o" t-set="o" t-value="doc"/>

            <t t-if="not company">
                <!-- Multicompany -->
                <t t-if="company_id">
                    <t t-set="company" t-value="company_id"/>
                </t>
                <t t-elif="o and 'company_id' in o and o.company_id.sudo()">
                    <t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
                <t t-else="else">
                    <t t-set="company" t-value="res_company"/>
                </t>
            </t>
            <div t-attf-class="header o_company_#{company.id}_layout" t-att-style="report_header_style">
                <div class="row mb8">
                    <div class="col-3">
                        <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo" style="width:100%;max-width:150px;"/>
                    </div>
                    <div class="col-5 text-center mb4" style="color:#144b9d">
                        <h4><strong><t t-esc="o.company_id.commercial_name"/></strong></h4>
                        Mata Redonda, San José
                        <!--<t t-if="o.company_id.street" t-esc="o.company_id.street"/>,-->
                        <!--<t t-if="o.company_id.street2" t-esc="o.company_id.street2"/><br/>-->
                        Apdo. 3876-1000 San José<br/>
                        Teléfono: <t t-esc="o.company_id.phone"/><br/>
                        Cédula Jurídica No <t t-esc="o.company_id.vat"/><br/>
                    </div>
                    <div class="col-1"/>
                    <div class="col-3 text-left mb4">
                        <!--div class="text-center"-->
                        <div class="redbold">
                            <h4><strong id="payment_title">RECIBO DE PAGO</strong></h4>
                            <span>No.:</span>
                            <span t-esc="o.name"/>
                        </div>
                        <div>
                            Fecha pago: <span t-field="o.date">2023-01-01</span><br/>
                            <!-- Condición de Pago: <t t-esc="o.payment_term_id and o.payment_term_id.name or 'CONTADO'"/><br/>
                            Moneda: <span t-esc="o.currency_id.name=='CRC' and 'Colones' or 'Dólares'"/> -->
                            <div t-if="report_type == 'pdf'" class="text-muted">
                                Página: <span class="page"/> / <span class="topage"/>
                            </div>
                        </div>
                    </div>
                </div>
                <!--<div class="encabezado-proveedor">-->
                    <div class="row mb8">
                        <div class="col-3">
                            <strong>
                                <div class="col-6" t-if="o.partner_type">
                                    <t t-if="o.partner_type == 'customer'">
                                        Recibí de:
                                    </t>
                                    <t t-else="o.partner_type == 'supplier'">
                                        Entregamos a:
                                    </t>
                                </div>
                            </strong>
                        </div>
                        <div class="col-9">
                            <t t-if="o.partner_id.parent_id">
                                <span t-field="o.partner_id.parent_id.name"/>-<span t-field="o.partner_id.parent_id.ref"/><br/>
                            </t>
                            <t t-else="">
                                <span t-field="o.partner_id.name"/>-<span t-field="o.partner_id.ref"/>
                            </t>
                        </div>
                    </div>
                    <div class="row mb8">


                        <div class="col-3">
                            <span>
                                <strong>La suma de:</strong>
                            </span>
                        </div>
                        <div class="col-9">
                            <span t-field="o.amount" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}">50 USD</span>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-3">
                            <span>
                                <strong>Por medio de:</strong>
                            </span>
                        </div>
                        <div class="col-9">
                            <span t-field="o.journal_id.name">BAC San José</span>
                        </div>
                    </div>
                    <div class="row mb8">
                        <div class="col-3">
                            <span>
                                <strong>No. Referencia Bancaria:</strong>
                            </span>
                        </div>
                        <div class="col-9">
                            <span t-field="o.ref">TR-12345</span>
                        </div>
                    </div>
                <!--</div>-->
                <t t-if="company.watermark">
                    <!--div class="row"
                            style="height:1000px; width:1500px;margin-left:10%;margin-top:30%;"-->
                    <!--<div class="row" style="margin-left:0%;margin-top:20%;">-->
                    <div class="row">
                        <div class="col-6" name="watermark">
                            <span t-attf-style="-webkit-transform:rotate(-{{company.rotating_angle}}deg);font-size:{{company.font_size}}px;text-align:center;position:absolute;text-align:center;opacity:1;">
                                <t t-if="company.watermark_type == 'text'">
                                    <t t-esc="company.content_text"/>
                                </t>
                                <t t-if="company.watermark_type == 'image'">
                                    <img t-if="company.background_image" t-att-src="image_data_uri(company.background_image)"/>
                                </t>
                                <t t-if="company.watermark_type == 'logo'">
                                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="position:absolute;height:200px; width:300px; opacity: 1;"/>
                                </t>
                            </span>
                        </div>
                    </div>
                </t>

                <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css"/>
                <style type="text/css">
                    body {
                        font-family: 'Droid Sans', Arial, sans-serif;
                        font-size:12px;

                    }
                    .redbold{
                        color:#ec2028;
                        font-weight:bolder;
                        font-size:13px;
                        border:none;
                        padding:5px 5px;
                    }
                    .encabezado-proveedor {
                        background-color: #f6deb3;
                        border: 1px solid; /*#3e783f;*/
                        /*border-radius: 10px 10px 10px 10px; / * Bordes redondeados */
                        padding: 10px;
                        /*font-weight: bold;*/
                    }
                </style>
            </div>

            <div t-attf-class="article o_report_layout_standard o_company_#{company.id}_layout {{  'o_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  '' }}" t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                <div class="pt-5">
                    <t t-call="web.address_layout"/>
                </div>
                <t t-out="0"/>
            </div>

            <div t-attf-class="footer o_standard_footer o_company_#{company.id}_layout">
                <!--div t-if="company.report_footer" class="text-center" style="border-top: 1px solid black;">
                    <ul class="list-inline mb4">
                        <div t-field="company.report_footer"/>
                    </ul>
                </div-->

                <!-- <div class="cuadro-pie">
                    <div class="row mb8">
                        <div class="invoice-cell col-9">
                            <p class="text-center"><strong>Esta orden es NULA sin la firma de la persona autorizada por TVCR</strong></p>
                            <strong>SEÑOR SUPLIDOR:</strong>
                            <li>La validez del presente documento está condicionada a su confirmación de recibido directamente al correo compras@teletica.com</li>
                            <li>Sírvase presentar esa orden de compra con el original de la factura para trámite de entrega o pago.</li>
                            <li>Si después de un plazo máximo de 30 días de emitida la factura no ha sido puesta al cobro, no se le dará trámite de pago.</li>
                        </div>
                        <div class="invoice-cell col-3">
                            <p class="text-center"><strong>Firma:</strong></p>
                        </div>
                    </div>
                </div>
                <p>Estimado Proveedor, es importante que el monto del Impuesto sobre las Ventas se muestre en su factura por separado cuando se trate de ítems o servicios gravados
        en cumplimiento a la Ley General sobe el Impuesto de Ventas y su Reglamento en el artículo 18, incisos 16, 17 y, 18. Cualquier documento que no cumpla con lo
        establecido no podrá ser tramitado.</p> -->
                <style type="text/css">
                    body {
                        font-family: 'Droid Sans', Arial, sans-serif;
                        font-size:12px;

                    }
                    .invoice-cell {
                    border: 1px solid black;
                    padding: 8px;
                    text-align: left;
                    }
                </style>
            </div>
       </template>

        <record id="view_payment_advance_form" model="ir.ui.view">
            <field name="name">account.payment.advance.form</field>
            <field name="model">account.payment</field>
            <field name="inherit_id" ref="account.view_account_payment_form" />
            <field name="arch" type="xml">
                <group name="group2" position="inside">
                    <field name="sale_id" readonly="state != 'draft'" domain="[('partner_id','=', partner_id)]"/>
                </group>
            </field>
        </record>

        <template id="report_payment_receipt_document_tvcr">
            <t t-call="cr_electronic_invoice_qweb_fe.external_layout_payment_receipt_tvcr">
                <t t-set="o" t-value="o.with_context(lang=lang)"/>
                <t t-set="values" t-value="o._get_payment_receipt_report_values()"/>
                <div class="page">
                    <div class="cuadro-detalle" style="height:140mm;">

                    <t t-set="partials" t-value="o.move_id._get_reconciled_invoices_partials()[0]"/>
                    <t t-set="invoices" t-value="{partial[2].move_id for partial in partials}"/>
                    <table name="invoices" t-if="invoices and values['display_invoices']" class="invoice-table table table-sm">
                        <!-- Check if invoices include different currencies -->
                        <t t-foreach="invoices" t-as="inv">
                            <t t-if="any(inv.currency_id != par[2].currency_id for par in inv._get_reconciled_invoices_partials()[0])" t-set="otherCurrency" t-value="True"/>
                        </t>
                        <thead>
                            <tr>
                                <th><span>Fecha Documento</span></th>
                                <th><span>Número Documento</span></th>
                                <th><span>Referencia</span></th>
                                <!-- Add a column if there are different currencies -->
                                <th t-if="otherCurrency" class="text-end"><span>Monto Original</span></th>
                                <th class="text-end"><span>Monto CRC</span></th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="invoices" t-as="inv">
                                <!-- MOVE -->
                                <t t-if="inv.move_type != 'entry'">
                                    <tr>
                                        <td><span t-field="inv.invoice_date">2023-01-01</span></td>
                                        <td><span t-field="inv.name">INV001</span></td>
                                        <td><span t-field="inv.ref">Sample Ref</span></td>
                                        <td t-if="otherCurrency"/>
                                        <td class="text-end"><span t-field="inv.amount_total">100.00 USD</span></td>
                                    </tr>
                                    <!-- PAYMENTS/REVERSALS -->
                                    <tr t-foreach="inv._get_reconciled_invoices_partials()[0]" t-as="par">
                                        <t t-set="payment" t-value="par[2].move_id"/>
                                        <td><span t-field="payment.date">2023-01-05</span></td>
                                        <td><span t-field="payment.name">PAY001</span></td>
                                        <td><span t-field="payment.ref">Payment Ref</span></td>
                                        <t t-set="amountPayment" t-value="-payment.amount_total"/>
                                        <t t-set="amountInvoice" t-value="-par[1]"/>
                                        <t t-set="currencyPayment" t-value="payment.currency_id"/>
                                        <t t-set="currencyInvoice" t-value="inv.currency_id"/>
                                        <!-- Fill the column "Amount In Currency" only if necessary -->
                                        <td t-if="otherCurrency" class="text-end"><span t-if="currencyPayment != currencyInvoice" t-out="amountPayment" t-options="{'widget': 'monetary', 'display_currency': currencyPayment}">50.00 EUR</span></td>
                                        <td class="text-end"><span t-out="amountInvoice" t-options="{'widget': 'monetary', 'display_currency': currencyInvoice}">25.00 USD</span></td>
                                    </tr>
                                    <!-- BALANCE -->
                                    <tr>
                                        <td/>
                                        <td><strong>Saldo pendiente para <span t-field="inv.name">INV001</span></strong></td>
                                        <td/>
                                        <td t-if="otherCurrency"/>
                                        <td class="text-end"><strong><span t-field="inv.amount_residual">25.0 USD</span></strong></td>
                                    </tr>
                                </t>
                            </t>
                        </tbody>
                    </table>
                    <t t-if="not invoices and o.sale_id">
                        <t t-set="payments" t-value="{payment for payment in o.sale_id.account_payment_ids if payment.state=='posted'}"/>
                        <t t-if="any(payment.currency_id != o.currency_id for payment in payments)" t-set="otherCurrency2" t-value="True"/>
                        <table name="sale_orders" class="invoice-table table table-sm">
                            <thead>
                                <tr>
                                    <th><span>Fecha Documento</span></th>
                                    <th><span>Número Documento</span></th>
                                    <th><span>Referencia</span></th>
                                    <!-- Add a column if there are different currencies -->
                                    <th t-if="otherCurrency2" class="text-end"><span>Monto Original</span></th>
                                    <th class="text-end"><span>Monto CRC</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span t-field="o.sale_id.date_order">2023-01-01</span></td>
                                    <td><span t-field="o.sale_id.name">SO001</span></td>
                                    <td><span t-field="o.sale_id.origin">10324</span></td>
                                    <td t-if="otherCurrency2"/>
                                    <td class="text-end"><span t-field="o.sale_id.amount_total">100.00 USD</span></td>
                                </tr>
                                <t t-foreach="payments" t-as="payment">
                                    <!-- MOVE -->
                                    <tr>
                                    <!-- PAYMENTS/REVERSALS -->
                                        <td><span t-field="payment.date">2023-01-05</span></td>
                                        <td><span t-field="payment.name">BNK-00121</span></td>
                                        <td><span t-field="payment.ref">Payment Ref</span></td>
                                        <t t-set="amountPayment" t-value="-payment.amount_total"/>
                                        <!--t t-set="amountSaleOrder" t-value="-par[1]"/-->                                        <!--t t-set="currencyPayment" t-value="payment.currency_id"/-->
                                        <!--t t-set="currencySale" t-value="o.currency_id"/-->
                                        <!-- Fill the column "Amount In Currency" only if necessary -->
                                        <td t-if="otherCurrency2"/>
                                        <!--td t-if="otherCurrency2" class="text-end"><span t-if="currencyPayment != currencyInvoice" t-out="amountPayment" t-options="{'widget': 'monetary', 'display_currency': currencyPayment}">50.00 EUR</span></td-->
                                        <td class="text-end"><span t-out="payment.amount" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}">25.00 USD</span></td>
                                    </tr>
                                </t>
                                <!-- BALANCE -->
                                <tr>
                                    <td/>
                                    <td><strong>Saldo pendiente para <span t-field="o.sale_id.name">SO001</span></strong></td>
                                    <td/>
                                    <td t-if="otherCurrency2"/>
                                    <td class="text-end"><strong><span t-field="o.sale_id.amount_residual" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}">25.0 USD</span></strong></td>
                                </tr>
                            </tbody>
                        </table>


                    </t>
                    <style type="text/css">
                        body {
                            font-family: 'Droid Sans', Arial, sans-serif;
                            font-size:12px;
            
                        }
                        .cuadro-detalle {
                            border: 1px solid #3c7896;
                            border-radius: 10px 10px 0 0; /* Bordes redondeados solo arriba */
                            height:160mm;
                            width:100%;
                            font-family: sans-serif;
                            /*overflow: hidden; / * Importante para evitar que el contenido se desborde */
                        }

                        .encabezado {
                            background-color: #d9edf8;
                            color: #3c7896;
                            padding: 10px;
                            font-weight: bold;
                            border-radius: 10px 10px 0 0;
                        }
                        .invoice-table {
                        border-collapse: collapse;
                        width: 100%; /* Opcional: Ancho de la tabla */
                        }
                        
                        .invoice-cell, .invoice-header-cell {
                            border: 1px solid #3c7896;
                        padding: 8px;
                        text-align: left;
                        }
                        
                        .invoice-header {
                            background-color: #d9edf8;
                            color: #3c7896;
                        }
                    </style>
                </div>
            </div>
            <div class="oe_structure"/>
            </t>
        </template>

        <template id="account.report_payment_receipt">
                <t t-call="web.html_container">
                    <t t-foreach="docs" t-as="o">
                        <t t-set="lang" t-value="o.partner_id.lang or o.company_id.partner_id.lang"/>
                        <t t-call="cr_electronic_invoice_qweb_fe.report_payment_receipt_document_tvcr" t-lang="lang"/>
                    </t>
                </t>
        </template>
    </data>
</odoo>
